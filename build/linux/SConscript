import os
import subprocess

Import('env')

if env['DEBUG']:
    env.Append(CXXFLAGS='-g')
#    env.Append(CXXFLAGS='-fprofile-arcs')
#    env.Append(CXXFLAGS='-ftest-coverage')
    env.Append(LIBS=['gcov'])
else:
    env.Append(CXXFLAGS='-O3')
    env.Append(LIBS=[])

#variant = GetOption('variant')
#env = SConscript(os.path.join(variant, 'SConscript'), exports=['env'])

# get number of available cores
p = subprocess.Popen("grep \"core id\" /proc/cpuinfo | wc -l", shell=True, stdout=subprocess.PIPE)
SetOption('num_jobs', int(p.stdout.read()[:-1]) * 2);
#print "Running with", GetOption('num_jobs'), "jobs"

Return('env')
